
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Benedict Chan</title>
  <meta name="author" content="Benedict Chan">

   
  <meta name="description" content="Benedict Chan's thoughts, questions, and development notes">
  
  <meta name="keywords" content="Benedict, Chan, Hong Kong, Sydney, Australia, .Net, C#, ASP.NET, MVC, Dependence Inject, TDD, SQL, Javascript, jQuery, Angularjs, CSS3, HTML5, bootstrap">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://benedict-chan.github.io">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Benedict Chan" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <script src="/js/application.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-47537615-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="navbar navbar-inverse navbar-static-top">
  	<div class="navbar-inner">
  	  <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
  	  	<div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
  	      <ul class="nav">
    
</ul>

<ul class="nav pull-right">
    
    <li><a href="http://github.com/benedict-chan" title="Github Profile"><i class="icon-github-sign social-navbar"></i></a></li>
    
    
    
    
    
    
    

    
</ul>

  	    </div>
  	  </div>
  	</div>
  </div>
  <div class="container" id="main">
      <div class="row-fluid">
        <div id="content">
          <div class="jumbotron">
  <div class="container">
    
      Benedict Chan
    
    <h3 class="tagline">
      
        software journey
      
    </h3>
  </div>
</div>


<div class="blog-index">
  
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2018-12-08T10:38:22+00:00" pubdate data-updated="true">Dec 8<span>th</span>, 2018</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/docker/"><span class="badge">docker</span></a>
          
          <a href="/blog/categories/ubuntu/"><span class="badge">ubuntu</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2018/12/08/setting-up-ubuntu-and-docker/">Setting up Ubuntu and Docker</a></h1>
      <p>This post just listed some commands I used for setting up a testing Ubuntu machine and Docker.</p>

<h3>Install xfce using apt</h3>

<pre><code>    sudo apt-get update
    sudo apt-get install xfce4
</code></pre>

<h3>Install xrdp using apt</h3>

<pre><code>    sudo apt-get install xrdp
    sudo systemctl enable xrdp
    echo xfce4-session &gt;~/.xsession
    sudo service xrdp restart

    # *Setting up a password for the rdp user*
    sudo passwd {username}
</code></pre>

<h3>Setting up Docker</h3>

<pre><code>    sudo apt-get install \
        apt-transport-https \
        ca-certificates \
        curl \
        software-properties-common

    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

    sudo add-apt-repository \
       "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
       $(lsb_release -cs) \
       stable"

    sudo apt-get update

    sudo apt-get install docker-ce
</code></pre>

<h3>Setting up Docker Compose</h3>

<pre><code>    sudo curl -L https://github.com/docker/compose/releases/download/1.23.1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose
    sudo chmod +x /usr/local/bin/docker-compose
</code></pre>

<h3>Common methods for SSH under Windows</h3>

<pre><code>    # *Generating SSH key with a specific location*
    ssh-keygen -t rsa -b 2048 -C "{comment/email}" -f {KeyLocation}

    # *Copying the SSH public key*
    clip &lt; {KeyLocation}.pub

    # *SSH using a key with a specific location*
    ssh username@hostip -i {KeyLocation}
</code></pre>

<h3>Setup Firefox</h3>

<pre><code>    sudo apt-get install firefox
</code></pre>

      
      
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2018-10-18T10:23:39+00:00" pubdate data-updated="true">Oct 18<span>th</span>, 2018</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/docker/"><span class="badge">docker</span></a>
          
          <a href="/blog/categories/octopress/"><span class="badge">octopress</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2018/10/18/use-docker-to-setup-an-environment-for-octopress2/">Use Docker to setup an environment for Octopress2</a></h1>
      <h2>Docker image for running Octopress 2</h2>

<p>Since this blog is made from Octopress 2 and it seems that Octopress has ended it&rsquo;s development after version 3.</p>

<p>In order to keep using it, it&rsquo;s better to create an development environment that I can keep on running it in the future.</p>

<p>The DockerFile for setting this environment is located <a href="https://github.com/benedict-chan/dockers/tree/master/octopress2">here</a>.</p>

<p>The Docker image is located in Docker Hub: <a href="https://hub.docker.com/r/benedictchan/octopress2/">https://hub.docker.com/r/benedictchan/octopress2/</a>.</p>

<h3>Running the environment</h3>

<p>To simply use this Docker image, you can just mount your Octopress repository&rsquo;s source branch to the container&rsquo;s <code>app</code> folder:</p>

<p><code>docker run -ti --rm -p 4000:4000 -v {source_path}:/app benedictchan/octopress2</code></p>


      
       <a href="/blog/2018/10/18/use-docker-to-setup-an-environment-for-octopress2/">Read on &rarr;</a> 
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2015-02-18T03:07:38+00:00" pubdate data-updated="true">Feb 18<span>th</span>, 2015</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/d3/"><span class="badge">d3</span></a>
          
          <a href="/blog/categories/data-visualisation/"><span class="badge">data visualisation</span></a>
          
          <a href="/blog/categories/javascript/"><span class="badge">javascript</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2015/02/18/making-a-simple-bar-chart-in-d3/">Making a simple bar chart in d3 with animation</a></h1>
      <p>Although you can see lots of amazing charts in the home page of d3, d3 doesn&rsquo;t ship with any pre-built chart function.
In this post, I am going to draw a simple animated bar chart using d3.
The output will be:</p>

<iframe width="100%" height="300" src="//jsfiddle.net/benedict_chan/rn8rdvt8/7/embedded/result,js,html,css/" allowfullscreen="allowfullscreen" frameborder="0">
</iframe>





      
       <a href="/blog/2015/02/18/making-a-simple-bar-chart-in-d3/">Read on &rarr;</a> 
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-12-11T00:33:44+00:00" pubdate data-updated="true">Dec 11<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/ipython-notebook/"><span class="badge">ipython notebook</span></a>
          
          <a href="/blog/categories/pandas/"><span class="badge">pandas</span></a>
          
          <a href="/blog/categories/python/"><span class="badge">python</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/12/11/a-taste-in-pandas/">A taste in Pandas, ipython notebook</a></h1>
      <p>After setting up the python enviornment in the
<a href="http://benedict-chan.github.io/blog/2014/11/07/setup-python-environment-in-visual-studio/">previous post</a>. I am going to run some python scripts to test our enviornment.</p>

<h3>The exercise</h3>

<p>The example is actually some exercises provided by the following link:
<a href="http://nbviewer.ipython.org/urls/raw.github.com/nborwankar/LearnDataScience/master/notebooks/A2.%20Linear%20Regression%20-%20Data%20Exploration%20-%20Lending%20Club.ipynb" target="_blank">A2. Linear Regression &ndash; Data Exploration &ndash; Lending Club</a>, which is part of the page <a href="https://github.com/nborwankar/LearnDataScience" target="_blank">Learn Data Science</a>.</p>

<p>The exercise includes:
&ndash; Reading a sample csv data into <code>pandas</code>
&ndash; Removing % signs from rates
&ndash; Removing the word &ldquo;months&rdquo; from loan length.
&ndash; Managing outliers, remove such rows in this case</p>

<p>I have implemented them as an <code>ipython notebook</code> and it can be previewed <a href="http://nbviewer.ipython.org/github/benedict-chan/pytest/blob/master/LearnDataScience/a2-linear-regression.ipynb" target="_blank" >here</a>.</p>

      
      
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-11-17T05:13:22+00:00" pubdate data-updated="true">Nov 17<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/data/"><span class="badge">data</span></a>
          
          <a href="/blog/categories/sql/"><span class="badge">sql</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/11/17/exporting-data-to-csv-in-sql-server/">Exporting data to CSV in SQL Server using bcp</a></h1>
      <p>There are several ways to export data in SQL Server, in this post, I am using <code>bcp</code> with <code>xp_cmdshell</code>.</p>

<p>We will first create a simple select statement to test whether we can export our data, then we will use a stored procedure to handle complex queries. Finally we will try to add variables to our script so that we can make this export script to be run in SQL Server Agent as a scheduled task.</p>

<h3>Test the export with a simple select statement</h3>

<figure class='code'><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div></pre></td><td class='main  sql'><pre><div class='line'><span class="k">exec</span> <span class="n">master</span><span class="p">..</span><span class="n">xp_cmdshell</span> <span class="s1">&#39;bcp &quot;select * from DataSeries&quot; queryout &quot;C:\Export\dataseries.csv&quot; -c -t&quot;,&quot; -r&quot;\n&quot; -T&#39;</span>
</div></pre></td></tr></table></div></figure>


<p>However, you will receive an error of:
[SQL Server]Invalid object name &lsquo;Table&rsquo;.</p>

<p>So, in order to run this simple query, we actually need to tell SQL Server the full name of our table schema, which should be:</p>

<figure class='code'><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div></pre></td><td class='main  sql'><pre><div class='line'><span class="k">exec</span> <span class="n">master</span><span class="p">..</span><span class="n">xp_cmdshell</span> <span class="s1">&#39;bcp &quot;select * from [db_name].[dbo].[DataSeries]&quot; queryout &quot;C:\Export\dataseries.csv&quot; -c -t&quot;,&quot; -r&quot;\n&quot; -T&#39;</span>
</div></pre></td></tr></table></div></figure>


<h3>Complex Query, use stored procedure</h3>


      
       <a href="/blog/2014/11/17/exporting-data-to-csv-in-sql-server/">Read on &rarr;</a> 
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-11-07T05:33:14+00:00" pubdate data-updated="true">Nov 7<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/anaconda/"><span class="badge">anaconda</span></a>
          
          <a href="/blog/categories/python/"><span class="badge">python</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/11/07/setup-python-environment-in-visual-studio/">Setup Python (Anaconda) Environment in Visual Studio</a></h1>
      <h2>Installing Python (Anaconda)</h2>

<p>In the old days, setting up an python environment with packages like NumPy SciPy in Windows may takes several hours. This may include building NumPy or SciPy yourself.</p>

<p>Now, to save our day, we can actually just install them easily by some special distributions like:</p>

<ul>
<li><a href="http://enthought.com/" target="_blank">EPD Free Enthought Python Distribution</a></li>
<li><a href="http://continuum.io/" target="_blank">Anaconda Python</a></li>
</ul>


<p>Here, I am going to install Anaconda, simply download the Windows installer and you are done.</p>

<h2>Setup Visual Studio as your Python IDE</h2>

<p>To use Visual Studio as your Python IDE, we can install the <a href="http://pytools.codeplex.com/" target="_blank" >Python Tools for Visual Studio (PTVS)</a>.</p>

<h2>Setup Python Environment &ndash; Anaconda</h2>

<p>Now that we have installed (PTVS), we have to tell (PTVS) where to find our Python distributions, in this case, the one that Anaconda installed.
We can configu it from:</p>

<p>From Visual Studio &ndash;> Options &ndash;> Python Tools &ndash;> Environment Options</p>

<p>We can setup our new Anaconda environment like this:</p>

<p><img class="center" src="/images/posts/2014-11-07-PythonEnvironmentOptions.jpg" title="" ></p>

<p>Once we have finished the setup, we can create a Python Project in Visual Studio, then try to run it our script using :</p>

<p>From Visual Studio &ndash;> Options &ndash;> Python Tools &ndash;> Execute Project in Python Interactive</p>

      
      
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-08-13T10:02:01+00:00" pubdate data-updated="true">Aug 13<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/autofac/"><span class="badge">autofac</span></a>
          
          <a href="/blog/categories/dependency-injection/"><span class="badge">dependency injection</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/08/13/resolving-implementations-at-runtime-in-autofac/">Resolving implementations at runtime using Autofac</a></h1>
      <p>There are lots of ways on resolving your services and implementations at runtime in Autofac. Following is a simple example to demonstrate how we can do it.</p>

<p>Assumng we have a simple interface <code>IDataService</code> that will provide us some data.</p>

<figure class='code'><figcaption>IDataService.cs</figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number'></div><div data-line='3' class='line-number'></div><div data-line='4' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>    <span class="k">public</span> <span class="k">interface</span> <span class="n">IDataService</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="kt">string</span> <span class="nf">GetData</span><span class="p">();</span>
</div><div class='line'>    <span class="p">}</span>
</div></pre></td></tr></table></div></figure>


<p>We are consuming this service and will return our users the data based on their <code>Role</code>, there are two roles in this example.
And we are providing different implementation for the <code>IDataService</code> for each role.</p>

<figure class='code'><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number'></div><div data-line='3' class='line-number'></div><div data-line='4' class='line-number'></div><div data-line='5' class='line-number'></div><div data-line='6' class='line-number'></div><div data-line='7' class='line-number'></div><div data-line='8' class='line-number'></div><div data-line='9' class='line-number'></div><div data-line='10' class='line-number'></div><div data-line='11' class='line-number'></div><div data-line='12' class='line-number'></div><div data-line='13' class='line-number'></div><div data-line='14' class='line-number'></div><div data-line='15' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>    <span class="k">public</span> <span class="k">enum</span> <span class="n">RoleName</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="n">Premium</span><span class="p">,</span>
</div><div class='line'>        <span class="n">Normal</span>
</div><div class='line'>    <span class="p">}</span>
</div><div class='line'> </div><div class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">PremiumDataService</span> <span class="p">:</span> <span class="n">IDataService</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="p">....</span>
</div><div class='line'>    <span class="p">}</span>
</div><div class='line'> </div><div class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">NormalDataService</span> <span class="p">:</span> <span class="n">IDataService</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="p">....</span>
</div><div class='line'>    <span class="p">}</span>
</div></pre></td></tr></table></div></figure>


<h2>Simple Solution using Func&lt;> as our factory in Autofac</h2>

<p>We will use a simple function <code>Func&lt;RoleName, IDataService&gt;</code> as our dependency in our <code>Controller</code>. It will act as our factory so that we can consume this factory to get our expected data.</p>

<figure class='code'><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number'></div><div data-line='3' class='line-number'></div><div data-line='4' class='line-number'></div><div data-line='5' class='line-number'></div><div data-line='6' class='line-number'></div><div data-line='7' class='line-number'></div><div data-line='8' class='line-number'></div><div data-line='9' class='line-number'></div><div data-line='10' class='line-number'></div><div data-line='11' class='line-number'></div><div data-line='12' class='line-number'></div><div data-line='13' class='line-number'></div><div data-line='14' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>        <span class="k">private</span> <span class="k">readonly</span> <span class="n">Func</span><span class="p">&lt;</span><span class="n">RoleName</span><span class="p">,</span> <span class="n">IDataService</span><span class="p">&gt;</span> <span class="n">_dataServiceFactory</span><span class="p">;</span>
</div><div class='line'>        <span class="k">public</span> <span class="nf">HomeController</span><span class="p">(</span><span class="n">Func</span><span class="p">&lt;</span><span class="n">RoleName</span><span class="p">,</span> <span class="n">IDataService</span><span class="p">&gt;</span> <span class="n">dataServiceFactory</span><span class="p">)</span>
</div><div class='line'>        <span class="p">{</span>
</div><div class='line'>            <span class="k">this</span><span class="p">.</span><span class="n">_dataServiceFactory</span> <span class="p">=</span> <span class="n">dataServiceFactory</span><span class="p">;</span>
</div><div class='line'>        <span class="p">}</span>
</div><div class='line'> </div><div class='line'>        <span class="k">public</span> <span class="n">ActionResult</span> <span class="nf">GetData</span><span class="p">()</span>
</div><div class='line'>        <span class="p">{</span>
</div><div class='line'>            <span class="p">....</span>
</div><div class='line'> </div><div class='line'>            <span class="kt">var</span> <span class="n">dataService</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">_dataServiceFactory</span><span class="p">(</span><span class="n">roleType</span><span class="p">);</span>
</div><div class='line'>            <span class="kt">var</span> <span class="n">data</span> <span class="p">=</span> <span class="n">dataService</span><span class="p">.</span><span class="n">GetData</span><span class="p">();</span>
</div><div class='line'>            <span class="p">....</span>
</div><div class='line'>        <span class="p">}</span>
</div></pre></td></tr></table></div></figure>





      
       <a href="/blog/2014/08/13/resolving-implementations-at-runtime-in-autofac/">Read on &rarr;</a> 
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-03-28T05:14:24+00:00" pubdate data-updated="true">Mar 28<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/asp-dot-net-mvc/"><span class="badge">asp.net mvc</span></a>
          
          <a href="/blog/categories/authentication/"><span class="badge">authentication</span></a>
          
          <a href="/blog/categories/claims/"><span class="badge">claims</span></a>
          
          <a href="/blog/categories/owin/"><span class="badge">owin</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/03/28/authentication-logics-from-asp-dot-net-mvc-4-to-5/">Authentication logics from ASP.NET MVC 4 to 5</a></h1>
      <h2>OWIN</h2>

<p>To allow security sharing by other components that can be hosted on <a href="http://owin.org/" target="_blank">OWIN</a>.
<strong>ASP.NET MVC 5</strong>  has applied a new security feature based on the <strong>OWIN</strong> authentication middleware.</p>

<p>For more information, please click <a href="http://blogs.msdn.com/b/webdev/archive/2013/07/03/understanding-owin-forms-authentication-in-mvc-5.aspx" target="_blank">here</a>.</p>

<p>To start, let&rsquo;s create a new project based on Visual Studio 2013&rsquo;s  template: <strong>Individual User Accounts</strong>.</p>

<h2>MVC5 Template: Individual User Accounts</h2>

<p>Have a look in the <code>web.config</code> of this newly created project. We will find that <code>FormsAuthenticationModule</code> is removed.</p>

<figure class='code'><figcaption>web.config </figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number'></div><div data-line='3' class='line-number'></div><div data-line='4' class='line-number'></div><div data-line='5' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'><span class="p">&lt;</span><span class="n">system</span><span class="p">.</span><span class="n">webServer</span><span class="p">&gt;</span>
</div><div class='line'>    <span class="p">&lt;</span><span class="n">modules</span><span class="p">&gt;</span>
</div><div class='line'>        <span class="p">&lt;</span><span class="k">remove</span> <span class="n">name</span><span class="p">=</span><span class="s">&quot;FormsAuthenticationModule&quot;</span> <span class="p">/&gt;</span>
</div><div class='line'>    <span class="p">&lt;/</span><span class="n">modules</span><span class="p">&gt;</span>
</div><div class='line'><span class="p">&lt;/</span><span class="n">system</span><span class="p">.</span><span class="n">webServer</span><span class="p">&gt;</span>
</div></pre></td></tr></table></div></figure>


<p>Now also have a look in what&rsquo;s the new logic is added for supporting <strong>OWIN</strong>.</p>

<figure class='code'><figcaption>\app_start\startup.auth.cs</figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='10' class='line-number'></div><div data-line='11' class='line-number'></div><div data-line='12' class='line-number'></div><div data-line='13' class='line-number marked start'></div><div data-line='14' class='line-number marked'></div><div data-line='15' class='line-number marked'></div><div data-line='16' class='line-number marked'></div><div data-line='17' class='line-number marked end'></div><div data-line='18' class='line-number'></div><div data-line='19' class='line-number marked start end'></div></pre></td><td class='main  csharp'><pre><div class='line'>    <span class="k">public</span> <span class="k">void</span> <span class="nf">ConfigureAuth</span><span class="p">(</span><span class="n">IAppBuilder</span> <span class="n">app</span><span class="p">)</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="c1">// Enable the application to use a cookie to store information for the signed in user</span>
</div><div class='line marked start'>        <span class="n">app</span><span class="p">.</span><span class="n">UseCookieAuthentication</span><span class="p">(</span><span class="k">new</span> <span class="n">CookieAuthenticationOptions</span>
</div><div class='line marked'>        <span class="p">{</span>
</div><div class='line marked'>            <span class="n">AuthenticationType</span> <span class="p">=</span> <span class="n">DefaultAuthenticationTypes</span><span class="p">.</span><span class="n">ApplicationCookie</span><span class="p">,</span>
</div><div class='line marked'>            <span class="n">LoginPath</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PathString</span><span class="p">(</span><span class="s">&quot;/Account/Login&quot;</span><span class="p">)</span>
</div><div class='line marked end'>        <span class="p">});</span>
</div><div class='line'>        <span class="c1">// Use a cookie to temporarily store information about a user logging in with a third party login provider</span>
</div><div class='line marked start end'>        <span class="n">app</span><span class="p">.</span><span class="n">UseExternalSignInCookie</span><span class="p">(</span><span class="n">DefaultAuthenticationTypes</span><span class="p">.</span><span class="n">ExternalCookie</span><span class="p">);</span>
</div></pre></td></tr></table></div></figure>


<p>It looks like the template offers a <code>Cookie</code> authentication as default, does it work if we applies our <strong>ASP.NET MVC 4</strong>&rsquo;s <code>FormsAuthenticationTicket</code> to it?</p>


      
       <a href="/blog/2014/03/28/authentication-logics-from-asp-dot-net-mvc-4-to-5/">Read on &rarr;</a> 
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-02-24T06:18:57+00:00" pubdate data-updated="true">Feb 24<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/asp-dot-net-mvc/"><span class="badge">asp.net mvc</span></a>
          
          <a href="/blog/categories/dependency-injection/"><span class="badge">dependency injection</span></a>
          
          <a href="/blog/categories/unit-test/"><span class="badge">unit test</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/02/24/adding-email-templates-service-in-your-asp-dot-net-mvc-projects-using-ioc/">Adding Email Templates service in your ASP.NET MVC projects using IoC</a></h1>
      <p>It looks obvious to give your web applications to send an email with some templates engine.
After some googling, I decided to use <a href="http://aboutcode.net/postal/" target="_blank">Postal</a> as the preferred service because:
1. It uses Razor engine for the template, which everyone is familar with
2. It is based on the .NET framework&rsquo;s built in SmptClient ( so you can just config it using web.config )
3. It is designed to be used in a dependency injection pattern (provide unit testing for your controllers or classes)</p>

<h2>Using the IEmailService</h2>

<p>With a decoupled design, it is possible you will seperate your logics include sending an email in your logic classes but not in your asp.net controller.
Therefore, an IEmailService that supports dependency injection is a better way to use than having an Email service just be used in a controller.
To apply Postal in your class, we can simply inject it&rsquo;s IEmailService to our business logic class.</p>

<figure class='code'><figcaption>BusinessService.cs</figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number'></div><div data-line='3' class='line-number'></div><div data-line='4' class='line-number'></div><div data-line='5' class='line-number'></div><div data-line='6' class='line-number'></div><div data-line='7' class='line-number'></div><div data-line='8' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">BusinessService</span> <span class="p">:</span> <span class="n">IBusinessService</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IEmailService</span> <span class="n">_emailService</span><span class="p">;</span>
</div><div class='line'>        <span class="k">public</span> <span class="nf">BusinessService</span><span class="p">(</span><span class="n">IEmailService</span> <span class="n">emailService</span><span class="p">)</span>
</div><div class='line'>        <span class="p">{</span>
</div><div class='line'>            <span class="k">this</span><span class="p">.</span><span class="n">_emailService</span> <span class="p">=</span> <span class="n">emailService</span><span class="p">;</span>
</div><div class='line'>        <span class="p">}</span>
</div><div class='line'>    <span class="p">}</span>
</div></pre></td></tr></table></div></figure>


<h3>And your controller</h3>

<figure class='code'><figcaption>SomeController.cs</figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number'></div><div data-line='3' class='line-number'></div><div data-line='4' class='line-number'></div><div data-line='5' class='line-number'></div><div data-line='6' class='line-number'></div><div data-line='7' class='line-number'></div><div data-line='8' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">SomeController</span> <span class="p">:</span> <span class="n">Controller</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IBusinessService</span> <span class="n">_businessService</span><span class="p">;</span>
</div><div class='line'> </div><div class='line'>        <span class="k">public</span> <span class="nf">SomeController</span><span class="p">(</span><span class="n">IBusinessService</span> <span class="n">businessService</span><span class="p">)</span>
</div><div class='line'>        <span class="p">{</span>
</div><div class='line'>            <span class="k">this</span><span class="p">.</span><span class="n">_businessService</span> <span class="p">=</span> <span class="n">businessService</span><span class="p">;</span>
</div><div class='line'>        <span class="p">}</span>
</div></pre></td></tr></table></div></figure>


<h3>Register the service using Autoface as our IoC</h3>

<figure class='code'><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>            <span class="n">builder</span><span class="p">.</span><span class="n">RegisterType</span><span class="p">&lt;</span><span class="n">EmailService</span><span class="p">&gt;().</span><span class="n">As</span><span class="p">&lt;</span><span class="n">IEmailService</span><span class="p">&gt;();</span>
</div></pre></td></tr></table></div></figure>


<p>Now you can create your email templates in your <code>Views\Emails</code> folder and send it inside your business logics class</p>

      
      
    </div>
  </div>



    </article>
    
    <hr>
    
  
  
    <article>
      

  <div class="row-fluid">
    <div class="span2 post-meta">
	  <h5 class="date-time">








  


<i class="icon-calendar-empty"></i> <time datetime="2014-02-12T06:14:23+00:00" pubdate data-updated="true">Feb 12<span>th</span>, 2014</time></h5>
          <div class="row-fluid">
          
          </div>
          
          <div class="row-fluid">
          
          <a href="/blog/categories/asp-dot-net-mvc/"><span class="badge">asp.net mvc</span></a>
          
          <a href="/blog/categories/dependency-injection/"><span class="badge">dependency injection</span></a>
          
          <a href="/blog/categories/orchard-cms/"><span class="badge">orchard cms</span></a>
          
          </div>
          
    </div>
    <div class="span10 post-container">
      <h1 class="link"><a href="/blog/2014/02/12/creating-custom-filter-attribute-in-orchard/">Creating custom Filter Attribute in Orchard</a></h1>
      <h2>Filter in Orchard</h2>

<p>When working in Orchard, it&rsquo;s always a good idea to look at the current codebase as an example.</p>

<p>The one I chose as a reference in creating my custom filter attribute is the <code>Theme</code> filter.</p>

<p>It is located in <code>$\Orchard\Themes\ThemeFilter.cs</code> inside the <code>Orchard.Framework</code> project.</p>

<p>You will notice that <code>ThemeFilter</code> is actually inherited from a class called <code>FilterProvider</code>.</p>

<figure class='code'><figcaption>ThemeFilter.cs</figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='1' class='line-number'></div><div data-line='2' class='line-number marked start end'></div><div data-line='3' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'><span class="k">namespace</span> <span class="nn">Orchard.Themes</span> <span class="p">{</span>
</div><div class='line marked start end'>    <span class="k">public</span> <span class="k">class</span> <span class="nc">ThemeFilter</span> <span class="p">:</span> <span class="n">FilterProvider</span><span class="p">,</span> <span class="n">IActionFilter</span><span class="p">,</span> <span class="n">IResultFilter</span> <span class="p">{</span>
</div><div class='line'>        <span class="k">public</span> <span class="k">void</span> <span class="nf">OnActionExecuting</span><span class="p">(</span><span class="n">ActionExecutingContext</span> <span class="n">filterContext</span><span class="p">)</span> <span class="p">{</span>
</div></pre></td></tr></table></div></figure>


<p>Now lets have a look inside <code>FilterProvider</code>.</p>

<figure class='code'><figcaption>ThemeFilter.cs</figcaption><div class='highlight'><table><tr><td class='line-numbers' aria-hidden='true'><pre><div data-line='8' class='line-number'></div><div data-line='9' class='line-number'></div><div data-line='10' class='line-number'></div><div data-line='11' class='line-number'></div><div data-line='12' class='line-number'></div><div data-line='13' class='line-number'></div><div data-line='14' class='line-number marked start'></div><div data-line='15' class='line-number marked'></div><div data-line='16' class='line-number marked'></div><div data-line='17' class='line-number marked'></div><div data-line='18' class='line-number marked'></div><div data-line='19' class='line-number marked'></div><div data-line='20' class='line-number marked'></div><div data-line='21' class='line-number marked end'></div><div data-line='22' class='line-number'></div><div data-line='23' class='line-number'></div><div data-line='24' class='line-number'></div></pre></td><td class='main  csharp'><pre><div class='line'>    <span class="k">public</span> <span class="k">abstract</span> <span class="k">class</span> <span class="nc">FilterProvider</span> <span class="p">:</span> <span class="n">IFilterProvider</span> <span class="p">{</span>
</div><div class='line'>        <span class="k">void</span> <span class="n">IFilterProvider</span><span class="p">.</span><span class="n">AddFilters</span><span class="p">(</span><span class="n">FilterInfo</span> <span class="n">filterInfo</span><span class="p">)</span> <span class="p">{</span>
</div><div class='line'>            <span class="n">AddFilters</span><span class="p">(</span><span class="n">filterInfo</span><span class="p">);</span>
</div><div class='line'>        <span class="p">}</span>
</div><div class='line'> </div><div class='line'>        <span class="k">protected</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">AddFilters</span><span class="p">(</span><span class="n">FilterInfo</span> <span class="n">filterInfo</span><span class="p">)</span> <span class="p">{</span>
</div><div class='line marked start'>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">is</span> <span class="n">IAuthorizationFilter</span><span class="p">)</span>
</div><div class='line marked'>                <span class="n">filterInfo</span><span class="p">.</span><span class="n">AuthorizationFilters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">this</span> <span class="k">as</span> <span class="n">IAuthorizationFilter</span><span class="p">);</span>
</div><div class='line marked'>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">is</span> <span class="n">IActionFilter</span><span class="p">)</span>
</div><div class='line marked'>                <span class="n">filterInfo</span><span class="p">.</span><span class="n">ActionFilters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">this</span> <span class="k">as</span> <span class="n">IActionFilter</span><span class="p">);</span>
</div><div class='line marked'>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">is</span> <span class="n">IResultFilter</span><span class="p">)</span>
</div><div class='line marked'>                <span class="n">filterInfo</span><span class="p">.</span><span class="n">ResultFilters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">this</span> <span class="k">as</span> <span class="n">IResultFilter</span><span class="p">);</span>
</div><div class='line marked'>            <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="k">is</span> <span class="n">IExceptionFilter</span><span class="p">)</span>
</div><div class='line marked end'>                <span class="n">filterInfo</span><span class="p">.</span><span class="n">ExceptionFilters</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">this</span> <span class="k">as</span> <span class="n">IExceptionFilter</span><span class="p">);</span>
</div><div class='line'>        <span class="p">}</span>
</div><div class='line'> </div><div class='line'>    <span class="p">}</span>
</div></pre></td></tr></table></div></figure>


<p>Bingo, it turns out that if you create a class to inherit <code>FilterProvider</code> and some <code>IActionFilter</code>, they will be automatically applied to your actions as <code>ActionFilter</code> already.</p>

<p>Note that Orchard is clever enough to help you to inject your dependencies using Autofac by constructor injection too.</p>

<h2>Attribute in Orchard</h2>


      
       <a href="/blog/2014/02/12/creating-custom-filter-attribute-in-orchard/">Read on &rarr;</a> 
    </div>
  </div>



    </article>
    
  
  <div class="pagination">
    
    <a class="prev" href="/blog/page/2/">&larr; Older</a>
    

    
  </div>
</div>


        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2020 - Benedict Chan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>


        </footer>
      </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'benedictchan';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
